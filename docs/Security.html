<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>S√©curit√© - ComfyUI MCP Server</title>
<style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .danger-box {
            background: #f8d7da;
            border-left: 5px solid #dc3545;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .content-card {
            background: white;
            padding: 30px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h2 { 
            color: #667eea; 
            margin: 30px 0 15px 0;
            font-size: 1.8em;
        }
        h3 { 
            color: #764ba2; 
            margin: 20px 0 10px 0;
        }
        ul { 
            margin-left: 20px; 
            margin-top: 10px;
        }
        li { 
            margin: 8px 0; 
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }
        .icon { font-size: 1.5em; margin-right: 10px; }
    </style>
</head>
<body>
<div class="container">
<header>
<h1>üîê Guide de S√©curit√©</h1>
<p>ComfyUI MCP Server - Bonnes Pratiques</p>
</header>
<div class="danger-box">
<h2><span class="icon">‚ö†Ô∏è</span>AVERTISSEMENT CRITIQUE</h2>
<p><strong>Ce serveur MCP n'impl√©mente PAS d'authentification par d√©faut.</strong></p>
<p>Toute personne ayant acc√®s √† l'URL du serveur peut :</p>
<ul>
<li>Lire tous vos workflows ComfyUI</li>
<li>Ex√©cuter des g√©n√©rations d'images</li>
<li>Lire et modifier vos custom nodes</li>
<li>Acc√©der √† l'historique de g√©n√©ration</li>
</ul>
</div>
<div class="content-card">
<h2>‚ùå Ce Qu'il Ne Faut JAMAIS Faire</h2>
<h3>1. Port Forwarding Direct</h3>
<div class="danger-box">
<p><strong>NE JAMAIS</strong> ouvrir le port 8000 directement sur Internet via votre routeur</p>
<pre>‚ùå BAD: Port forwarding 8000 ‚Üí Votre IP publique
‚úÖ GOOD: Utiliser un tunnel s√©curis√© (Cloudflare, ngrok)</pre>
</div>
<h3>2. Partager les Tokens Publiquement</h3>
<div class="danger-box">
<p><strong>NE JAMAIS</strong> commiter <code>.env</code> dans Git ou partager les tokens</p>
<pre>‚ùå BAD: git add .env &amp;&amp; git push
‚úÖ GOOD: Ajouter .env dans .gitignore</pre>
</div>
<h3>3. Exposition Sans HTTPS</h3>
<div class="danger-box">
<p><strong>NE JAMAIS</strong> exposer le serveur en HTTP non chiffr√© sur Internet</p>
<pre>‚ùå BAD: http://mon-ip:8000 accessible publiquement
‚úÖ GOOD: https://tunnel.example.com (Cloudflare Tunnel)</pre>
</div>
</div>
<div class="content-card">
<h2>‚úÖ Bonnes Pratiques de S√©curit√©</h2>
<h3>1. Utilisation Locale Uniquement (Recommand√©)</h3>
<div class="success-box">
<p>La m√©thode la plus s√ªre : ne jamais exposer le serveur</p>
<pre>‚úÖ Serveur sur 127.0.0.1:8000
‚úÖ Interfaces Gradio sur 127.0.0.1:7860
‚úÖ Tout reste sur votre machine</pre>
<p><strong>Avantages</strong> :</p>
<ul>
<li>Aucun risque d'acc√®s externe</li>
<li>Pas de configuration r√©seau</li>
<li>Performance maximale</li>
</ul>
</div>
<h3>2. Tunnel Cloudflare (Si Acc√®s Distant N√©cessaire)</h3>
<div class="success-box">
<p>Cloudflare Tunnel fournit HTTPS automatique + protection DDoS</p>
<pre># Installation
curl -L https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64 -o cloudflared
chmod +x cloudflared
sudo mv cloudflared /usr/local/bin/

# Lancement du tunnel
cloudflared tunnel --url http://localhost:8000</pre>
<p><strong>Avantages</strong> :</p>
<ul>
<li>HTTPS automatique (chiffrement)</li>
<li>Protection DDoS int√©gr√©e</li>
<li>Pas besoin d'ouvrir de ports</li>
<li>URL temporaire ou domaine custom</li>
</ul>
</div>
<h3>3. Variables d'Environnement S√©curis√©es</h3>
<div class="success-box">
<p>Toujours utiliser <code>.env</code> pour les secrets</p>
<pre># .env (JAMAIS dans Git)
MCP_API_KEY=votre-cl√©-g√©n√©r√©e-ici
WEBSOCKET_TOKEN=votre-token-websocket
COMFYUI_URL=http://127.0.0.1:8188

# .gitignore
.env
*.key
*.pem</pre>
</div>
<h3>4. Firewalling Local</h3>
<div class="warning-box">
<p>Bloquer l'acc√®s r√©seau au serveur MCP</p>
<pre># Linux (ufw)
sudo ufw deny 8000/tcp
sudo ufw allow from 127.0.0.1 to any port 8000

# Windows (PowerShell Admin)
New-NetFirewallRule -DisplayName "Block MCP External" `
    -Direction Inbound -LocalPort 8000 -Protocol TCP `
    -Action Block -RemoteAddress Any</pre>
</div>
</div>
<div class="content-card">
<h2>üõ°Ô∏è Niveaux de S√©curit√© par M√©thode</h2>
<table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
<thead>
<tr style="background: #667eea; color: white;">
<th style="padding: 12px; text-align: left;">M√©thode</th>
<th style="padding: 12px; text-align: center;">S√©curit√©</th>
<th style="padding: 12px; text-align: left;">Recommandation</th>
</tr>
</thead>
<tbody>
<tr style="background: #d4edda;">
<td style="padding: 12px;"><strong>Gradio Local (Ollama)</strong></td>
<td style="padding: 12px; text-align: center;">üü¢ √âlev√©e</td>
<td style="padding: 12px;">Parfait pour usage personnel</td>
</tr>
<tr style="background: #d4edda;">
<td style="padding: 12px;"><strong>Gradio Local (Gemini)</strong></td>
<td style="padding: 12px; text-align: center;">üü¢ √âlev√©e</td>
<td style="padding: 12px;">API Key Google √† prot√©ger</td>
</tr>
<tr style="background: #fff3cd;">
<td style="padding: 12px;"><strong>ChatGPT Desktop (local)</strong></td>
<td style="padding: 12px; text-align: center;">üü° Moyenne</td>
<td style="padding: 12px;">OK si 127.0.0.1 uniquement</td>
</tr>
<tr style="background: #fff3cd;">
<td style="padding: 12px;"><strong>Cloudflare Tunnel</strong></td>
<td style="padding: 12px; text-align: center;">üü° Moyenne</td>
<td style="padding: 12px;">Ajouter authentification custom</td>
</tr>
<tr style="background: #f8d7da;">
<td style="padding: 12px;"><strong>Port Forwarding Direct</strong></td>
<td style="padding: 12px; text-align: center;">üî¥ Faible</td>
<td style="padding: 12px;">‚ùå √Ä √âVITER ABSOLUMENT</td>
</tr>
</tbody>
</table>
</div>
<div class="content-card">
<h2>üîç Checklist de S√©curit√©</h2>
<h3>Avant de D√©marrer</h3>
<ul style="list-style-type: none;">
<li>‚òê G√©n√©rer des cl√©s uniques avec <code>generate_key.py</code></li>
<li>‚òê V√©rifier que <code>.env</code> est dans <code>.gitignore</code></li>
<li>‚òê Serveur MCP √©coute sur <code>127.0.0.1</code> (pas <code>0.0.0.0</code>)</li>
<li>‚òê Firewall local configur√© si n√©cessaire</li>
</ul>
<h3>Utilisation Quotidienne</h3>
<ul style="list-style-type: none;">
<li>‚òê Ne jamais partager l'URL du tunnel</li>
<li>‚òê Fermer le tunnel quand non utilis√©</li>
<li>‚òê V√©rifier les logs pour activit√©s suspectes</li>
<li>‚òê R√©g√©n√©rer les tokens p√©riodiquement</li>
</ul>
<h3>Si Compromission Suspect√©e</h3>
<ul style="list-style-type: none;">
<li>‚òê Arr√™ter imm√©diatement le serveur</li>
<li>‚òê R√©g√©n√©rer toutes les cl√©s (<code>generate_key.py</code>)</li>
<li>‚òê V√©rifier les workflows et custom nodes</li>
<li>‚òê Analyser les logs <code>/debug/health</code></li>
</ul>
</div>

<footer style="text-align: center; margin: 40px 0 20px 0; color: #666;">
<p style="margin-top: 10px;">ComfyUI MCP Server ¬© 2025</p>
</footer>
</div>
</body>
</html>

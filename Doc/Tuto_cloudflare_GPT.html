<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Cloudflare Tunnel + ChatGPT - ComfyUI MCP</title>
<style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: linear-gradient(135deg, #f96854 0%, #f77737 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .badge {
            display: inline-block;
            padding: 5px 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            font-size: 0.9em;
            margin: 5px;
        }
        .card {
            background: white;
            padding: 30px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .info-box {
            background: #e7f3ff;
            border-left: 5px solid #2196F3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .danger-box {
            background: #f8d7da;
            border-left: 5px solid #dc3545;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        h2 { 
            color: #f96854; 
            margin: 30px 0 15px 0;
            font-size: 1.8em;
            border-bottom: 2px solid #f96854;
            padding-bottom: 10px;
        }
        h3 { 
            color: #f77737; 
            margin: 20px 0 10px 0;
        }
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .step {
            background: linear-gradient(90deg, #f96854 0%, #f77737 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            margin: 20px 0 10px 0;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #f96854;
            color: white;
        }
        tr:hover {
            background: #f5f5f5;
        }
        ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        li {
            margin: 10px 0;
        }
        .icon { font-size: 1.5em; margin-right: 10px; }
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: #f96854;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 10px 5px;
            transition: background 0.3s;
        }
        .btn:hover {
            background: #e85743;
        }
    </style>
</head>
<body>
<div class="container">
<header>
<h1>üåê Cloudflare Tunnel + ChatGPT</h1>
<p>Exposer votre Serveur MCP de Mani√®re S√©curis√©e</p>
<div>
<span class="badge">üîí HTTPS Automatique</span>
<span class="badge">üõ°Ô∏è Protection DDoS</span>
<span class="badge">üåç Acc√®s Distant</span>
<span class="badge">üü° Interm√©diaire</span>
</div>
</header>
<div class="danger-box">
<h3><span class="icon">‚ö†Ô∏è</span>IMPORTANT : Lisez Ceci Avant de Continuer</h3>
<p>Cette m√©thode expose votre serveur MCP sur Internet via un tunnel s√©curis√©. <strong>Bien que plus s√ªr qu'un port forwarding direct</strong>, cela comporte des risques :</p>
<ul>
<li>‚ùå Toute personne avec l'URL peut acc√©der √† votre serveur MCP</li>
<li>‚ùå Le serveur actuel n'a pas d'authentification robuste</li>
<li>‚ùå Vos workflows et custom nodes deviennent potentiellement accessibles</li>
</ul>
<p><strong>‚úÖ Utilisez cette m√©thode uniquement si :</strong></p>
<ul>
<li>Vous comprenez les risques de s√©curit√©</li>
<li>Vous gardez l'URL du tunnel priv√©e</li>
<li>Vous fermez le tunnel quand vous ne l'utilisez pas</li>
</ul>

</div>
<div class="info-box">
<h3><span class="icon">‚ÑπÔ∏è</span>Qu'est-ce que Cloudflare Tunnel ?</h3>
<p>Cloudflare Tunnel (anciennement Argo Tunnel) cr√©e une connexion s√©curis√©e entre votre serveur local et le r√©seau Cloudflare, sans ouvrir de ports sur votre routeur.</p>
<p><strong>Avantages</strong> :</p>
<ul>
<li>‚úÖ HTTPS automatique (certificat SSL gratuit)</li>
<li>‚úÖ Protection DDoS int√©gr√©e</li>
<li>‚úÖ Pas besoin de configuration r√©seau/routeur</li>
<li>‚úÖ URL temporaire ou domaine personnalis√©</li>
<li>‚úÖ Totalement gratuit pour usage personnel</li>
</ul>
</div>
<div class="card">
<h2>üìã Pr√©requis</h2>
<ul>
<li>‚úÖ Serveur MCP ComfyUI configur√© et fonctionnel</li>
<li>‚úÖ ChatGPT Desktop install√© (ou acc√®s web ChatGPT)</li>
<li>‚úÖ Connexion Internet stable</li>
<li>‚úÖ Compte Cloudflare (gratuit, optionnel pour domaine custom)</li>
</ul>
</div>
<div class="card">
<h2>üöÄ Installation de Cloudflare Tunnel</h2>
<div class="step">√âtape 1 : Installer cloudflared</div>
<h3>Sur Windows</h3>
<pre># T√©l√©charger depuis le site officiel
https://github.com/cloudflare/cloudflared/releases/latest

# T√©l√©charger : cloudflared-windows-amd64.exe
# Renommer en : cloudflared.exe
# Placer dans : C:\Windows\System32\ (ou ajouter au PATH)</pre>
<h3>Sur macOS</h3>
<pre># Via Homebrew
brew install cloudflared

# V√©rification
cloudflared --version</pre>
<h3>Sur Linux</h3>
<pre># Debian/Ubuntu
wget -q https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb
sudo dpkg -i cloudflared-linux-amd64.deb

# Arch Linux
yay -S cloudflared

# Autres distributions (binaire)
wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64
chmod +x cloudflared-linux-amd64
sudo mv cloudflared-linux-amd64 /usr/local/bin/cloudflared

# V√©rification
cloudflared --version</pre>
<div class="success-box">
<strong>‚úÖ V√©rification</strong> : Vous devriez voir la version de cloudflared s'afficher.
            </div>
</div>
<div class="card">
<h2>üåê Cr√©er le Tunnel</h2>
<div class="step">M√©thode 1 : Tunnel Temporaire (Rapide et Simple)</div>
<div class="info-box">
<p><strong>Parfait pour</strong> : Tests rapides, usage ponctuel</p>
<p><strong>Limitations</strong> : URL change √† chaque d√©marrage, pas de logs persistants</p>
</div>
<h3>D√©marrer le serveur MCP</h3>
<pre># Terminal 1
cd ComfyUI_mcp
python server.py

# V√©rifier que le serveur tourne sur http://127.0.0.1:8000</pre>
<h3>Cr√©er le tunnel temporaire</h3>
<pre># Terminal 2
cloudflared tunnel --url http://localhost:8000

# Vous verrez quelque chose comme :
# Your quick Tunnel has been created! Visit it at:
# https://random-words-1234.trycloudflare.com</pre>
<div class="success-box">
<h3><span class="icon">üéâ</span>Tunnel Cr√©√© !</h3>
<p>Copiez l'URL g√©n√©r√©e (ex: <code>https://random-words-1234.trycloudflare.com</code>)</p>
<p>Cette URL est maintenant accessible depuis n'importe o√π dans le monde et pointe vers votre serveur local.</p>
</div>
<div class="warning-box">
<strong>‚ö†Ô∏è Note</strong> : Gardez le terminal ouvert. Si vous le fermez, le tunnel s'arr√™te.
            </div>
<div class="step">M√©thode 2 : Tunnel Permanent avec Domaine Custom (Avanc√©)</div>
<div class="info-box">
<p><strong>Parfait pour</strong> : Usage r√©gulier, URL fixe personnalis√©e</p>
<p><strong>Pr√©requis</strong> : Compte Cloudflare + domaine (optionnel)</p>
</div>
<h3>1. Cr√©er un compte Cloudflare</h3>
<pre># Aller sur : https://dash.cloudflare.com/sign-up
# Cr√©er un compte gratuit</pre>
<h3>2. Authentifier cloudflared</h3>
<pre># Cette commande ouvre votre navigateur
cloudflared tunnel login

# S√©lectionnez votre domaine (ou "None" pour URL Cloudflare)
# Un certificat est t√©l√©charg√© dans ~/.cloudflared/</pre>
<h3>3. Cr√©er un tunnel nomm√©</h3>
<pre># Cr√©er le tunnel
cloudflared tunnel create comfyui-mcp

# Vous verrez :
# Created tunnel comfyui-mcp with id: xxxx-xxxx-xxxx-xxxx
# Credentials written to: ~/.cloudflared/xxxx-xxxx-xxxx-xxxx.json</pre>
<h3>4. Configurer le tunnel</h3>
<pre># Cr√©er le fichier de config
nano ~/.cloudflared/config.yml

# Contenu du fichier :
tunnel: comfyui-mcp
credentials-file: /home/USER/.cloudflared/TUNNEL-ID.json

ingress:
  - hostname: comfyui.votredomaine.com  # Ou laisser vide pour auto
    service: http://localhost:8000
  - service: http_status:404</pre>
<h3>5. Router le domaine (optionnel)</h3>
<pre># Si vous avez un domaine
cloudflared tunnel route dns comfyui-mcp comfyui.votredomaine.com</pre>
<h3>6. D√©marrer le tunnel permanent</h3>
<pre># D√©marrer
cloudflared tunnel run comfyui-mcp

# Ou en service syst√®me (Linux)
sudo cloudflared service install
sudo systemctl start cloudflared
sudo systemctl enable cloudflared</pre>
</div>
<div class="card">
<h2>üí¨ Configuration ChatGPT Desktop</h2>
<div class="step">√âtape 1 : Ouvrir ChatGPT Desktop</div>
<p>Lancez l'application ChatGPT Desktop (macOS ou Windows)</p>
<div class="step">√âtape 2 : Activer le Developer Mode</div>
<ol>
<li>Cliquez sur votre <strong>avatar</strong> en haut √† droite</li>
<li>Allez dans <strong>Settings</strong></li>
<li>Section <strong>Beta features</strong> ou <strong>Connectors</strong></li>
<li>Activez <strong>Developer Mode</strong></li>
</ol>
<div class="step">√âtape 3 : Ajouter le Serveur MCP</div>
<ol>
<li>Dans une conversation, cliquez sur le bouton <strong>"+"</strong> √† c√¥t√© du champ de saisie</li>
<li>S√©lectionnez <strong>Developer Mode</strong></li>
<li>Cliquez sur <strong>Add sources</strong></li>
<li>Configurez :
                    <ul>
<li><strong>Name</strong> : ComfyUI MCP</li>
<li><strong>MCP Server URL</strong> : <code>https://votre-url.trycloudflare.com/mcp</code></li>
<li>‚ö†Ô∏è <strong>N'oubliez pas le /mcp √† la fin !</strong></li>
</ul>
</li>
<li>Cochez <strong>"I trust this application"</strong></li>
<li>Cliquez sur <strong>Create</strong></li>
<li>Cliquez sur <strong>Authorize</strong></li>
</ol>
<div class="success-box">
<h3><span class="icon">‚úÖ</span>Connexion √âtablie !</h3>
<p>ChatGPT devrait maintenant afficher les outils MCP disponibles dans le panneau lat√©ral.</p>
</div>
<div class="step">Alternative : Configuration Manuelle (Fichier JSON)</div>
<p>Si vous utilisez une version qui supporte la configuration par fichier :</p>
<pre># Emplacement du fichier de config ChatGPT
# macOS : ~/Library/Application Support/ChatGPT/
# Windows : %APPDATA%\ChatGPT\

# Cr√©er/√©diter chatgpt_config.json
{
  "mcpServers": {
    "comfyui": {
      "url": "https://votre-url.trycloudflare.com/mcp"
    }
  }
}</pre>
</div>
<div class="card">
<h2>üîå Configuration Claude Desktop</h2>
<div class="step">√âditer le Fichier de Configuration</div>
<h3>Sur macOS</h3>
<pre># Ouvrir le fichier
nano ~/Library/Application\ Support/Claude/claude_desktop_config.json</pre>
<h3>Sur Windows</h3>
<pre># Ouvrir le fichier
notepad %APPDATA%\Claude\claude_desktop_config.json</pre>
<h3>Configuration</h3>
<pre>{
  "mcpServers": {
    "comfyui": {
      "command": "npx",
      "args": [
        "mcp-remote",
        "https://votre-url.trycloudflare.com/mcp"
      ]
    }
  }
}</pre>
<div class="success-box">
<p>Red√©marrez Claude Desktop. Les outils MCP devraient appara√Ætre automatiquement.</p>
</div>
</div>
<div class="card">
<h2>üí¨ Utilisation avec ChatGPT</h2>
<h3>Exemples de Questions</h3>
<div class="info-box">
<ul>
<li>"Liste mes workflows ComfyUI disponibles"</li>
<li>"Cr√©e un nouveau custom node pour l'upscaling"</li>
<li>"Quel est le dernier √©l√©ment dans mon historique ?"</li>
<li>"Queue un prompt avec le workflow 'default'"</li>
<li>"Analyse le code de mon custom node et sugg√®re des am√©liorations"</li>
</ul>
</div>
<h3>V√©rifier que les Outils Sont Actifs</h3>
<p>Dans ChatGPT, vous devriez voir :</p>
<ul>
<li>Une ic√¥ne <strong>üîß</strong> ou <strong>üõ†Ô∏è</strong> indiquant que des outils sont disponibles</li>
<li>La liste des outils dans le panneau lat√©ral</li>
<li>ChatGPT mentionnera "Utilisation de l'outil X" quand il appelle un outil</li>
</ul>
</div>
<div class="card">
<h2>üîí S√©curit√© et Bonnes Pratiques</h2>
<div class="warning-box">
<h3><span class="icon">‚ö†Ô∏è</span>R√®gles de S√©curit√© Importantes</h3>
<ul>
<li>‚ùå <strong>Ne partagez JAMAIS l'URL du tunnel publiquement</strong></li>
<li>‚ùå Ne postez pas l'URL sur GitHub, forums, Discord, etc.</li>
<li>‚úÖ Fermez le tunnel quand vous ne l'utilisez pas (<code>Ctrl+C</code>)</li>
<li>‚úÖ Surveillez les logs du serveur pour activit√© suspecte</li>
<li>‚úÖ R√©g√©n√©rez un nouveau tunnel r√©guli√®rement</li>
</ul>
</div>
<h3>Surveillance des Acc√®s</h3>
<pre># Dans votre terminal serveur MCP, vous verrez toutes les requ√™tes
INFO:     127.0.0.1:xxxxx - "POST /mcp/tools/call HTTP/1.1" 200 OK

# Surveillez les requ√™tes inhabituelles</pre>
<h3>Limiter l'Acc√®s par IP (Cloudflare Dashboard)</h3>
<ol>
<li>Connectez-vous √† Cloudflare Dashboard</li>
<li>S√©lectionnez votre tunnel</li>
<li>Ajoutez des r√®gles WAF (Web Application Firewall)</li>
<li>Bloquez toutes les IPs sauf la v√¥tre</li>
</ol>
<h3>Rotation d'URL</h3>
<pre># Avec tunnel temporaire, cr√©ez une nouvelle URL r√©guli√®rement
# Fermez l'ancien tunnel (Ctrl+C)
# Red√©marrez avec une nouvelle URL
cloudflared tunnel --url http://localhost:8000</pre>
</div>
<div class="card">
<h2>‚ùì D√©pannage</h2>
<h3>‚ùå Erreur : "Bad Gateway" (502)</h3>
<div class="warning-box">
<p><strong>Probl√®me</strong> : Le serveur MCP n'est pas accessible</p>
<p><strong>Solutions</strong> :</p>
<ol>
<li>V√©rifier que le serveur MCP tourne : <code>python server.py</code></li>
<li>Tester localement : <code>curl http://127.0.0.1:8000/debug/health</code></li>
<li>V√©rifier le port dans la commande cloudflared (8000 par d√©faut)</li>
</ol>
</div>
<h3>‚ùå ChatGPT ne voit pas les outils</h3>
<div class="warning-box">
<p><strong>Probl√®me</strong> : URL incorrecte ou endpoint MCP non accessible</p>
<p><strong>Solutions</strong> :</p>
<ol>
<li>V√©rifier l'URL : doit se terminer par <code>/mcp</code></li>
<li>Tester l'endpoint : <code>curl https://votre-url.trycloudflare.com/mcp/tools/list -X POST</code></li>
<li>Red√©marrer ChatGPT Desktop</li>
<li>Supprimer et recr√©er la connexion MCP</li>
</ol>
</div>
<h3>‚ùå Tunnel se d√©connecte fr√©quemment</h3>
<div class="warning-box">
<p><strong>Probl√®me</strong> : Connexion Internet instable</p>
<p><strong>Solutions</strong> :</p>
<ul>
<li>Utiliser un tunnel permanent au lieu de temporaire</li>
<li>Installer cloudflared en tant que service syst√®me</li>
<li>V√©rifier votre connexion Internet</li>
</ul>
</div>
<h3>‚ùå "Tunnel credentials not found"</h3>
<div class="warning-box">
<p><strong>Probl√®me</strong> : Configuration du tunnel permanent incorrecte</p>
<p><strong>Solutions</strong> :</p>
<ol>
<li>V√©rifier que <code>cloudflared tunnel login</code> a √©t√© ex√©cut√©</li>
<li>V√©rifier le chemin dans <code>config.yml</code></li>
<li>Recr√©er le tunnel : <code>cloudflared tunnel create nouveau-nom</code></li>
</ol>
</div>
</div>
<div class="card">
<h2>üìä Comparaison des M√©thodes de Tunnel</h2>
<table>
<thead>
<tr>
<th>Crit√®re</th>
<th>Tunnel Temporaire</th>
<th>Tunnel Permanent</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Installation</strong></td>
<td>üü¢ Tr√®s simple</td>
<td>üü° Configuration requise</td>
</tr>
<tr>
<td><strong>URL</strong></td>
<td>üî¥ Change √† chaque fois</td>
<td>üü¢ Fixe et personnalisable</td>
</tr>
<tr>
<td><strong>Compte Cloudflare</strong></td>
<td>üü¢ Non requis</td>
<td>üî¥ Requis</td>
</tr>
<tr>
<td><strong>D√©marrage Auto</strong></td>
<td>‚ùå Non</td>
<td>‚úÖ Oui (service)</td>
</tr>
<tr>
<td><strong>Usage</strong></td>
<td>Tests, usage ponctuel</td>
<td>Usage r√©gulier</td>
</tr>
</tbody>
</table>
</div>
<div class="card">
<h2>üÜö Alternatives √† Cloudflare Tunnel</h2>
<h3>ngrok</h3>
<div class="info-box">
<p><strong>Similaire √† Cloudflare Tunnel</strong></p>
<pre># Installation
brew install ngrok  # macOS
choco install ngrok # Windows

# Utilisation
ngrok http 8000

# URL g√©n√©r√©e : https://xxxx.ngrok.io</pre>
<p><strong>Avantages</strong> : Interface web de monitoring</p>
<p><strong>Inconv√©nients</strong> : Moins stable que Cloudflare pour usage long</p>
</div>
<h3>localhost.run</h3>
<div class="info-box">
<p><strong>Le plus simple, aucune installation</strong></p>
<pre># SSH uniquement
ssh -R 80:localhost:8000 nokey@localhost.run

# URL g√©n√©r√©e : https://xxxx.lhr.life</pre>
<p><strong>Avantages</strong> : Aucune installation</p>
<p><strong>Inconv√©nients</strong> : Moins fiable, pas de configuration avanc√©e</p>
</div>
<h3>Recommandation</h3>
<div class="success-box">
<p>üèÜ <strong>Cloudflare Tunnel</strong> reste la meilleure option :</p>
<ul>
<li>Gratuit et illimit√©</li>
<li>Protection DDoS int√©gr√©e</li>
<li>Support officiel et maintenu</li>
<li>Meilleure stabilit√©</li>
</ul>
</div>
</div>


<footer style="text-align: center; margin: 40px 0 20px 0; color: #666;">
<p>ComfyUI MCP Server ¬© 2025</p>
</footer>
</div>
</body>
</html>
